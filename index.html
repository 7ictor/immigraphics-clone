<html>
<head>
	<title>Safe Trails</title>
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<!-- Optional theme -->
	<link rel="stylesheet" href="css/bootstrap-theme.min.css">
	<link rel="stylesheet" href="css/main.css">
	<script src="js/jquery-1.9.1.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
	<script src="js/md5.js"></script>

</head>
	<body>
		<nav class="navbar navbar-default" role="navigation">
		  <!-- Brand and toggle get grouped for better mobile display -->
		  <div class="navbar-header">
		    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
		      <span class="sr-only">Toggle navigation</span>
		      <span class="icon-bar"></span>
		      <span class="icon-bar"></span>
		      <span class="icon-bar"></span>
		    </button>
		    <a class="navbar-brand" href="#">Safe Trails</a>
		  </div>

		  <!-- Collect the nav links, forms, and other content for toggling -->
		  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
		    <ul class="nav navbar-nav">
		      <li id="submitCase"><a href="#">Submit</a></li>
		      <li><a href="#">Track</a></li>
		      <li><a href="search.html">Search</a></li>
		    </ul>
		    <!--<form class="navbar-form navbar-left" role="search">
		      <div class="form-group">
		        <input type="text" class="form-control" placeholder="Search">
		      </div>
		      <button type="submit" class="btn btn-default">Submit</button>
		    </form>-->
		  </div><!-- /.navbar-collapse -->
		</nav>

<div id="caseContainer" class="leftContainer">

				<div id="logIn" class="row text-center">
					<h3 >Welcome Back!</h3>
					<form id="login" class="form-horizontal col-md-12" role="form">
						
					  <div class="form-group">
					    <label for="userName" class="col-sm-3 control-label">Username</label>
					    <div class="col-sm-9">
					      <input type="text" class="form-control" id="userName" name="username" placeholder="Username">
					    </div>
					  </div>
					  <div class="form-group">
					    <label for="password" class="col-sm-3 control-label">Password</label>
					    <div class="col-sm-9">
					      <input type="password" class="form-control" id="password" name="password" placeholder="Password">
					    </div>
					  </div>
					  <div class="form-group">
					    <div class="col-sm-offset-2 col-sm-10">
					      <button type="button" id ="signIn" class="btn btn-default">Sign in</button>
					    </div>
					  </div>
					</form>
				</div>
				
				<div id="register" class="row text-center">
					<div class="message"></div>
					<h6 >Please create an account to submit your information to Safe Trails</h6>
					<form id = "newUser" class="form-horizontal col-md-12" role="form">
						
					  <div class="form-group">
					    <label for="newUserName" class="col-sm-3 control-label">Username</label>
					    <div class="col-sm-9">
					      <input type="text" class="form-control" id="newUserName" placeholder="Username">
					    </div>
					  </div>
					  <div class="form-group">
					    <label for="newPassword" class="col-sm-3 control-label">Password</label>
					    <div class="col-sm-9">
					      <input type="password" class="form-control" id="newPassword" placeholder="Password">
					    </div>
					  </div>
					  <div class="form-group">
					    <label for="newPassword2" class="col-sm-3 control-label">Confirm Password</label>
					    <div class="col-sm-9">
					      <input type="password" class="form-control" id="newPassword2" placeholder="Password">
					    </div>
					  </div>
					  <div class="form-group">
					    <label for="profession" class="col-sm-3 control-label">Profession</label>
					    <div class="col-sm-9">
					      <select id="profession" class = "form-control" name="profession">
					      	<option value="coroner">Coroner</option>
					      	<option value="doctor">Doctor</option>
					      	<option value="sherif">Sheriff</option>
					      </select>
					    </div>
					  </div>
					   <div class="form-group">
					    <label for="state" class="col-sm-3 control-label">State</label>
					    <div class="col-sm-9">
					      <select id="state" class = "form-control" name="state">
					      	<option value="AL">Alabama</option>
							<option value="AK">Alaska</option>
							<option value="AZ">Arizona</option>
							<option value="AR">Arkansas</option>
							<option value="CA">California</option>
							<option value="CO">Colorado</option>
							<option value="CT">Connecticut</option>
							<option value="DE">Delaware</option>
							<option value="DC">District Of Columbia</option>
							<option value="FL">Florida</option>
							<option value="GA">Georgia</option>
							<option value="HI">Hawaii</option>
							<option value="ID">Idaho</option>
							<option value="IL">Illinois</option>
							<option value="IN">Indiana</option>
							<option value="IA">Iowa</option>
							<option value="KS">Kansas</option>
							<option value="KY">Kentucky</option>
							<option value="LA">Louisiana</option>
							<option value="ME">Maine</option>
							<option value="MD">Maryland</option>
							<option value="MA">Massachusetts</option>
							<option value="MI">Michigan</option>
							<option value="MN">Minnesota</option>
							<option value="MS">Mississippi</option>
							<option value="MO">Missouri</option>
							<option value="MT">Montana</option>
							<option value="NE">Nebraska</option>
							<option value="NV">Nevada</option>
							<option value="NH">New Hampshire</option>
							<option value="NJ">New Jersey</option>
							<option value="NM">New Mexico</option>
							<option value="NY">New York</option>
							<option value="NC">North Carolina</option>
							<option value="ND">North Dakota</option>
							<option value="OH">Ohio</option>
							<option value="OK">Oklahoma</option>
							<option value="OR">Oregon</option>
							<option value="PA">Pennsylvania</option>
							<option value="RI">Rhode Island</option>
							<option value="SC">South Carolina</option>
							<option value="SD">South Dakota</option>
							<option value="TN">Tennessee</option>
							<option value="TX">Texas</option>
							<option value="UT">Utah</option>
							<option value="VT">Vermont</option>
							<option value="VA">Virginia</option>
							<option value="WA">Washington</option>
							<option value="WV">West Virginia</option>
							<option value="WI">Wisconsin</option>
							<option value="WY">Wyoming</option>
					      </select>
					    </div>
					  </div>
			  		  <div class="form-group">
					    <label for="email" class="col-sm-3 control-label">Email</label>
					    <div class="col-sm-9">
					      <input type="email" class="form-control" id="email" placeholder="Email">
					    </div>
					  </div>

					  <div class="form-group">
					    <div class="col-sm-offset-2 col-sm-10">
					      <button id="saveUser" type="button" class="btn btn-default">Create an account</button>
					    </div>
					  </div>
					</form>
				</div>

</div>

<div id="map-canvas"></div>

	</body>



<script type="text/javascript">


$(function(){
	$("#caseContainer").hide();
	initialize(30.600094,-105.076675);
});

$("#signIn").click(function(){
	logIn();
});
$("#saveUser").click(function(){
	saveUser();
});


$("#submitCase").click(function(){
	$("#caseContainer").toggle( "slow" );
});
function logIn(){
	var form = $("#login").serialize();
	var user = $("#userName").val();
	var pwd = $("#password").val();
	md5Pwd = CryptoJS.MD5(pwd).toString();
	console.log(md5Pwd);
	$.ajax({
		url: "http://safetrails.herokuapp.com/u/auth.php",
		   type: "POST",
		   data:{
			   username:user,
			   password:md5Pwd,
			},
		   xhrFields: {
		      withCredentials: false
		   },
		   crossDomain: true,
		   success: function(data){
		   		console.log(data);
		   		a = $.parseJSON(data);
		   		console.log(a);
		   		if(a.response=="success"){
		   			console.log("entro");
		   			window.location.href="submit_case.html"
		   		}else{
		   			$(".message").html("Wrong username or password, please try again");
		   		}
		   }
		});

}
function saveUser()
{

		_username = $("#newUserName").val();
		_password = $("#newPassword").val();

		p2 = $("#newPassword2").val();
		if(_password!=p2){
		  	alert("Passwords do not match");
		    return 
		}else{
		   _password = CryptoJS.MD5(_password).toString();
		 }
		_profession = $("#profession option:selected").text();
		_state =$("#state option:selected").text();
		_email =$("#email").val();
		 
		$.ajax({
				url: "http://safetrails.herokuapp.com/u/save.php",
				   type: "POST",
				   data:{
					   username:_username,
					   password:_password,
					   profession: _profession,
					   state:_state,
					   county:"test_county",
					   email:_email
					},
				   xhrFields: {
				      withCredentials: false
				   },
				   crossDomain: true,
				   success: function(data){
				   		console.log(data);
				   		a = $.parseJSON(data);
				   		console.log(a);
				   		if(a.response=="success"){
				   			console.log("entro");
				   			$(".message").html("User created.");
				   		}else{
				   			$(".message").html("error creating user");
				   		}
				   }
				});

  
}
function initialize(lat, lng) {
    google.maps.visualRefresh = true;
    start = new google.maps.LatLng(lat, lng);
    directionsDisplay = new google.maps.DirectionsRenderer();
    var mapOptions = {
        zoom: 6,
        center: start,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    map = new google.maps.Map(document.getElementById('map-canvas'),
      mapOptions);
    directionsDisplay.setMap(map);
    var marker = new google.maps.Marker({
        position: map.getCenter(),
        map: map,
        title: 'Your Address'
    });
}

	
</script>




</html>

